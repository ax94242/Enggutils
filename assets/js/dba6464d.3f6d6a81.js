(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5020],{8258:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return u},metadata:function(){return s},toc:function(){return c},default:function(){return p}});var o=n(2122),a=n(9756),l=(n(7294),n(3905)),i=["components"],u={sidebar_position:1,title:"How to get multiple values in a cell using vlookup?",description:"How to get multiple values in a cell using vlookup?",tags:["Excel","VBA"]},s={type:"mdx",permalink:"/excel/How-to-get-multiple-values-in-a-cell-using-lookup",source:"@site/src/pages/excel/How-to-get-multiple-values-in-a-cell-using-lookup.md"},c=[{value:"Settings",id:"settings",children:[]},{value:"Execution",id:"execution",children:[]}],r={toc:c};function p(e){var t=e.components,u=(0,a.Z)(e,i);return(0,l.kt)("wrapper",(0,o.Z)({},r,u,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("footer",{className:"my-5"},(0,l.kt)("a",{style:{color:"#252d4a"},href:"/excel/excel-topics"},(0,l.kt)("i",{class:"fa fa-chevron-circle-left fa-lg","aria-hidden":"true"})," Click here to go back")),(0,l.kt)("h1",{id:"how-to-get-multiple-values-in-a-cell-using-vlookup"},"How to get multiple values in a cell using vlookup?"),(0,l.kt)("p",null,"Using Excel VBA user can do vlookup from multiple cell and bring all values that matches condition in one cell."),(0,l.kt)("p",null,"Lets consider an example table (Table-1). Our target is to summarize the values in second column with respect to the first column and values should be separated by comma. In simple words, I want to see powerpoint, excel who uses it?"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Data Table",src:n(5382).Z})),(0,l.kt)("h2",{id:"settings"},"Settings"),(0,l.kt)("p",null,"Lets set up our excel VBA."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-md"},'Press [Alt] + [F11] to open developer mode in excel.\n\nor\n\nIf "Developer" option enabled in Excel then click on it.\n')),(0,l.kt)("p",null,'On left side screen under "VBA Project", right click on "Microsoft Excel Objects". A dialogue box will appear and then click on "Insert" and then "Module".'),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Data Table",src:n(4496).Z})),(0,l.kt)("p",null,"Copy-paste below code in created module and close the developer window."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'Function MultipleLookupNoRept(Lookupvalue As String, LookupRange As Range, ColumnNumber As Integer)\nDim i As Long\nDim Result As String\nFor i = 1 To LookupRange.Columns(1).Cells.Count\n  If LookupRange.Cells(i, 1) = Lookupvalue Then\n    For J = 1 To i - 1\n    If LookupRange.Cells(J, 1) = Lookupvalue Then\n      If LookupRange.Cells(J, ColumnNumber) = LookupRange.Cells(i, ColumnNumber) Then\n        GoTo Skip\n      End If\n    End If\n    Next J\n    Result = Result & " " & LookupRange.Cells(i, ColumnNumber) & ","\nSkip:\n  End If\nNext i\nMultipleLookupNoRept = Left(Result, Len(Result) - 1)\nEnd Function\n')),(0,l.kt)("h2",{id:"execution"},"Execution"),(0,l.kt)("p",null,"Go to your sheet and execute the excel VBA function that we just created. For our example, we take the unique values from first column and we will try summarizing the table.\nUse the function as if like normal vlookup function, syntax of the code is:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"= MultipleLookupNoRept(vlookup value, Range, Column number)\n")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Data Table",src:n(4989).Z})),(0,l.kt)("p",null,"All done!"),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"My tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Use this function when you have a small data-table. Using this function in bigger table or scaling up to big data can make you wait a lot longer like working with >100k rows. For >100k rows you may try converting this function into a coded program instead."))))}p.isMDXComponent=!0},5382:function(e,t){"use strict";t.Z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALsAAABlCAIAAACaxgViAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAa0SURBVHhe7Z1RYusoDEW7riwo68lqspL562JmJEBwhSGxpmnj4Ht+IrAEkrh13qs9b77+ISSCKuZfQvbxJVAxZD9UDIlBxZAYVAyJQcUI96t04XL7LsPK9+0iF673MiTKoorJZ90zEEXixYopm892+3C0tIXvMfnwnp3dCxUDUqViPpGBYpI8MjZfFHOzK6aRTjGghpkc1OVyu293XQet/kSKkXEZoBqKiNIAI9AH7RxQlbQB11gOqeyk30rwVQSmk8bYVB5Lhor5XLZnV+4nhali0ghk4sMyciF7JGATKuZz6c4OJIAyGSgm+YDpXJ5BxXwuI8WASpyNN5MsKlCMm38GFfO5bM6uiEO4XsVsirG/4aRLRReoGKHFJkbqyRHIPo19EFrUwoohL4eKITGoGBKDiiEximL0g5CdnO0eIyUXi8ShYkgMKobEoGJIDCqGxKBiSIxPVUx+FPT4UZ8+5Bk91qFifsKnKmYPVMxv0ClGmiw/ufUhLf4U42PZcg7uSDRoOBgEJof6Yq1MxvYVYIOcRReLUf3NSGaK5fzMC6agBEwvJ5ztbu310aK9YloX0iA3DUwcqFVmv2/XCwyqCUebpsvauft2IS+5f9+NYmpsv53ZiHgXa+Bxv5oG9CJmVDyzDQPzPwlafKcYaKH0P/Wjm67z7YDEQ3/O82xz7zu6DcxE98V479RcNtGGlFws9Ri6JFq8W8kNujpOwFPFpGHfl+ZmB3S/ylimdQCLqNmRz7Nb8f/sa1d8rCUkdItWJIliCZahBdWJTI53K7lBn+H6aFd+cI8xs9xdxC8NqnMfWOk6Hd4X4r1Tc5luLiUXq2HrwboQ71ZyA/Q/BwPFuD9PgOk6aaeSj+h6le+kMtC3IVsPvW+j63R4X4jX6baUplN80B8ZKcYWgXXVLLbbwg26Ok6ANGV7j0m9UrAXdRLu4AnobDfI6JqNEtt1OrwvxLsT1AvVzXbuZCMzxYK16xJ1Lv1dLs+6LdwA8jgJ2pr5t9Kf8af7SsnFInGoGBKDiiExOsWcAirmJxTF6AchO+E9huyHiiExqBgSg4ohMagYEuOPFHOoX6ZPFYNPGMgEKgagYnZAxQBUzA62itFf2Bt2yDpnveztAroaTSPHVUzLNz2rbooZFzIrefOi8bJoiagYPFrtRK8TnFPfZidrFn5UxfQ5DhMGpwdvAVePA1X6G3jFYAMVKb8OtRWXC1zf9mYefqg+NsVowpBWzfdRH4wW61cZ+a7EVjEdUL0e+8PWzMM19ICK6dKqFc0L8VeoGF+7J3VC/wsjc9iqYB6+9X0jUnKxuoSdYkbpYhnNx3vXRRbFKyYVP6zXeqUO1h6dM+f8Bf80/BA0xWAJqTIcDAqBMtQstjq34uTCsAWr0ClGyJ0zcvF44NjM5lubNAr3C7wdyatYQsv3ehe7Hfa8kDIxfgv4hIpZHym5WCQOFUNiUDEkBhVDYhTF6AchO+E9huyHiiExqBgSg4ohMagYEuOPFHPUpwT+F/zPifovCBVDxcSgYqiYGFvFaFMMa47O2QPZ3i6gq9F6e2zFaHYJfOg8LOSB/1nQulExeLTanl4nOKe+zU7WLBzn346UXKyUYy0iDXKWYG7nB/4nwitGe2CHrMhB12HSx2Lv+aaMIS9LuJtuhUz8z8RWMR3QET126Ne2XfNwDf0MxaRhn251m/ifCT1Vr5hZB5JAFnvPd6CAJPG+EJuf+Z8Jr5jUkWEP7MjVwXqmc+b8oe/5pnIsZcgey9zMD/xPRKcYITfFyB3BA8c+Nd/auVH4oRVzud1rypiiplxosnjgfxa0bq+Y9ZGSi0XiUDEkBhVDYlAxJEZRjH4QshPeY8h+qBgSg4ohMagYEoOKITH+SDFHfUpAwlAxJAYVQ2JsFYMPn+2QdQ6fV2+fXTtXo2nk0M+u9X/QnZEUa/7tgfWoTAnJbwvp3NVVp94QvBpaMSoGjxZLNxvn1LfZyZqF4/zbkZKLlXK0zLINg5L88N/w1YJaSbOyV0Trborpq5VO1KF2Ze33fN1gmHHz6C63oVtkRbaK6QAFaFugGzJEeQjz8GH/34WkVSx/vm4AGfuy8mRfkMW6NZZEe+AVM6s3CWTp93zdoGaMqTePTUH50rwDy+AVk+rubhwZ65A6WE90zpw/+D3fmpcb1IwhdTWLvS0odaZeXxetEf/k2yrP5PPH/qAqmm/VySh81OA3InkVK2Vb83KDXigK/Bu+g4Jy5d3kemgjvGLWR0ou1ms51I/Fr0HFvIxzCIaKeRknEQwVQ4IUxegHIXv4+voPr4ecefdgp94AAAAASUVORK5CYII="},4496:function(e,t,n){"use strict";t.Z=n.p+"assets/images/settings-92a183d60b9de3e5ccd99ce199b2762e.png"},4989:function(e,t,n){"use strict";t.Z=n.p+"assets/images/summary-table-922ae0f40b92694d913216f4288f833c.JPG"}}]);