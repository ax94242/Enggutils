<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.ff31de0ff">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="EnggUtils Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="EnggUtils Blog Atom Feed"><title data-react-helmet="true">How to get multiple values in a cell using vlookup? | EnggUtils</title><meta data-react-helmet="true" property="og:title" content="How to get multiple values in a cell using vlookup? | EnggUtils"><meta data-react-helmet="true" name="description" content="How to get multiple values in a cell using vlookup?"><meta data-react-helmet="true" property="og:description" content="How to get multiple values in a cell using vlookup?"><meta data-react-helmet="true" property="og:url" content="https://ax94242.github.io/excel/How-to-get-multiple-values-in-a-cell-using-lookup"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://ax94242.github.io/excel/How-to-get-multiple-values-in-a-cell-using-lookup"><link data-react-helmet="true" rel="alternate" href="https://ax94242.github.io/excel/How-to-get-multiple-values-in-a-cell-using-lookup" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://ax94242.github.io/excel/How-to-get-multiple-values-in-a-cell-using-lookup" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.93c3e795.css">
<link rel="preload" href="/assets/js/runtime~main.b57c4c8e.js" as="script">
<link rel="preload" href="/assets/js/main.1d721bff.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Home</strong></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">Topics</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/engineering-material-properties">Material Discovery</a></li><li><a class="dropdown__link" href="/website-design-free">Website Design</a></li><li><a class="dropdown__link" href="/software-installation">Softwares</a></li><li><a class="dropdown__link" href="/healthcare-regulatory-compliance/healthcare-public-affairs">HealthCare Regulatory Affairs</a></li><li><a class="dropdown__link" href="/Workplace/aptitude-test-study-guide">Workplace Aptitude Tests &amp; Guide</a></li><li><a class="dropdown__link" href="/transparency-reporting/transparency-reporting-countries">Transparency Report</a></li><li><a class="dropdown__link" href="/excel/excel-topics">Excel</a></li></ul></div><a class="navbar__item navbar__link" href="/library/appu-singh-library">Library</a><a class="navbar__item navbar__link" href="/digital-shelf">Courses</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/contact/contact-form">Connect</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Home</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">Topics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/engineering-material-properties">Material Discovery</a></li><li class="menu__list-item"><a class="menu__link" href="/website-design-free">Website Design</a></li><li class="menu__list-item"><a class="menu__link" href="/software-installation">Softwares</a></li><li class="menu__list-item"><a class="menu__link" href="/healthcare-regulatory-compliance/healthcare-public-affairs">HealthCare Regulatory Affairs</a></li><li class="menu__list-item"><a class="menu__link" href="/Workplace/aptitude-test-study-guide">Workplace Aptitude Tests &amp; Guide</a></li><li class="menu__list-item"><a class="menu__link" href="/transparency-reporting/transparency-reporting-countries">Transparency Report</a></li><li class="menu__list-item"><a class="menu__link" href="/excel/excel-topics">Excel</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/library/appu-singh-library">Library</a></li><li class="menu__list-item"><a class="menu__link" href="/digital-shelf">Courses</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/contact/contact-form">Connect</a></li></ul></div></div></div></nav><div class="main-wrapper mdx-wrapper mdx-page"><main><div class="container container--fluid"><div class="margin-vert--lg padding-vert--lg"><div class="row"><div class="col col--8 col--offset-2"><div class="container"><footer class="my-5"><a style="color:#252d4a" href="/excel/excel-topics"><i class="fa fa-chevron-circle-left fa-lg" aria-hidden="true"></i> Click here to go back</a></footer><h1><a aria-hidden="true" tabindex="-1" class="anchor" id="how-to-get-multiple-values-in-a-cell-using-vlookup"></a>How to get multiple values in a cell using vlookup?<a class="hash-link" href="#how-to-get-multiple-values-in-a-cell-using-vlookup" title="Direct link to heading">#</a></h1><p>Using Excel VBA user can do vlookup from multiple cell and bring all values that matches condition in one cell.</p><p>Lets consider an example table (Table-1). Our target is to summarize the values in second column with respect to the first column and values should be separated by comma. In simple words, I want to see powerpoint, excel who uses it?</p><p><img alt="Data Table" src="data:image/png;base64,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"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="settings"></a>Settings<a class="hash-link" href="#settings" title="Direct link to heading">#</a></h2><p>Lets set up our excel VBA.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly md"><div tabindex="0" class="prism-code language-md codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Press [Alt] + [F11] to open developer mode in excel.</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">or</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">If &quot;Developer&quot; option enabled in Excel then click on it.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>On left side screen under &quot;VBA Project&quot;, right click on &quot;Microsoft Excel Objects&quot;. A dialogue box will appear and then click on &quot;Insert&quot; and then &quot;Module&quot;.</p><p><img alt="Data Table" src="/assets/images/settings-92a183d60b9de3e5ccd99ce199b2762e.png"></p><p>Copy-paste below code in created module and close the developer window.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">Function MultipleLookupNoRept(Lookupvalue As String, LookupRange As Range, ColumnNumber As Integer)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Dim i As Long</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Dim Result As String</span></div><div class="token-line" style="color:#393A34"><span class="token plain">For i = 1 To LookupRange.Columns(1).Cells.Count</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  If LookupRange.Cells(i, 1) = Lookupvalue Then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    For J = 1 To i - 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    If LookupRange.Cells(J, 1) = Lookupvalue Then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      If LookupRange.Cells(J, ColumnNumber) = LookupRange.Cells(i, ColumnNumber) Then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        GoTo Skip</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      End If</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    End If</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Next J</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Result = Result &amp; &quot; &quot; &amp; LookupRange.Cells(i, ColumnNumber) &amp; &quot;,&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Skip:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  End If</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Next i</span></div><div class="token-line" style="color:#393A34"><span class="token plain">MultipleLookupNoRept = Left(Result, Len(Result) - 1)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">End Function</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="execution"></a>Execution<a class="hash-link" href="#execution" title="Direct link to heading">#</a></h2><p>Go to your sheet and execute the excel VBA function that we just created. For our example, we take the unique values from first column and we will try summarizing the table.
Use the function as if like normal vlookup function, syntax of the code is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">= MultipleLookupNoRept(vlookup value, Range, Column number)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><img alt="Data Table" src="/assets/images/summary-table-922ae0f40b92694d913216f4288f833c.JPG"></p><p>All done!</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>My tip</h5></div><div class="admonition-content"><p>Use this function when you have a small data-table. Using this function in bigger table or scaling up to big data can make you wait a lot longer like working with &gt;100k rows. For &gt;100k rows you may try converting this function into a coded program instead.</p></div></div></div></div><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#settings" class="table-of-contents__link">Settings</a></li><li><a href="#execution" class="table-of-contents__link">Execution</a></li></ul></div></div></div></div></div></main></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Digital Shelf Topics</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/digital-shelf">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://www.researchgate.net/profile/Appu-Singh" target="_blank" rel="noopener noreferrer" class="footer__link-item">Research Gate</a></li><li class="footer__item"><a href="https://www.facebook.com/appukumar.singh.796" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://grabcad.com/appusin-1" target="_blank" rel="noopener noreferrer" class="footer__link-item">GrabCAD</a></li><li class="footer__item"><a href="https://scholar.google.com/citations?user=yRSncV8AAAAJ&amp;hl=en" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google Scholar</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Terms-and-conditions">Terms and Conditions</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy-policy">Privacy Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">2021 EnggUtils, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b57c4c8e.js"></script>
<script src="/assets/js/main.1d721bff.js"></script>
</body>
</html>